

model {
  log_d ~ dnorm(0,1)
  alpha ~ dmnorm(rep(-3.5,2),prec_alpha)
  b ~ dmnorm(rep(0,max(A2)),prec_b)
  for(i in 1:n_cluster){
    Nr[i] <- N[i]*exp(alpha[U[i]] + b[A2[i]])
  }
  Yplus ~ dpois(sum(Nr))
  Y ~ dmulti(Nr,Yplus) ## gives error
  for(i in 1:n_cluster){
    Z[i] ~ dhyper(n[i],N[i]-n[i],Y[i],1)
  }

}